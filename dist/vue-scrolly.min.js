!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.Scrolly={})}(this,function(e){"use strict";function t(){if(!w){w=!0;var e=navigator.userAgent,t=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(e),o=/(Mac OS X)|(Windows)|(Linux)/.exec(e);if(v=/\b(iPhone|iP[ao]d)/.exec(e),m=/\b(iP[ao]d)/.exec(e),p=/Android/i.exec(e),y=/FBAN\/\w+;/i.exec(e),b=/Mobile/i.exec(e),f=!!/Win64/.exec(e),t){(r=t[1]?parseFloat(t[1]):t[5]?parseFloat(t[5]):NaN)&&document&&document.documentMode&&(r=document.documentMode);var n=/(?:Trident\/(\d+.\d+))/.exec(e);c=n?parseFloat(n[1])+4:r,a=t[2]?parseFloat(t[2]):NaN,i=t[3]?parseFloat(t[3]):NaN,(l=t[4]?parseFloat(t[4]):NaN)?(t=/(?:Chrome\/(\d+\.\d+))/.exec(e),s=t&&t[1]?parseFloat(t[1]):NaN):s=NaN}else r=a=i=s=l=NaN;if(o){if(o[1]){var g=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(e);d=!g||parseFloat(g[1].replace("_","."))}else d=!1;u=!!o[2],h=!!o[3]}else d=u=h=!1}}function o(e){var t=0,o=0,n=0,r=0;return"detail"in e&&(o=e.detail),"wheelDelta"in e&&(o=-e.wheelDelta/120),"wheelDeltaY"in e&&(o=-e.wheelDeltaY/120),"wheelDeltaX"in e&&(t=-e.wheelDeltaX/120),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(t=o,o=0),n=t*M,r=o*M,"deltaY"in e&&(r=e.deltaY),"deltaX"in e&&(n=e.deltaX),(n||r)&&e.deltaMode&&(1==e.deltaMode?(n*=X,r*=X):(n*=Y,r*=Y)),n&&!t&&(t=n<1?-1:1),r&&!o&&(o=r<1?-1:1),{spinX:t,spinY:o,pixelX:n,pixelY:r}}function n(e){return 100*e+"%"}var r,a,i,l,s,c,d,u,h,p,f,v,m,y,b,g,w=!1,S={ie:function(){return t()||r},ieCompatibilityMode:function(){return t()||c>r},ie64:function(){return S.ie()&&f},firefox:function(){return t()||a},opera:function(){return t()||i},webkit:function(){return t()||l},safari:function(){return S.webkit()},chrome:function(){return t()||s},windows:function(){return t()||u},osx:function(){return t()||d},linux:function(){return t()||h},iphone:function(){return t()||v},mobile:function(){return t()||v||m||p||b},nativeApp:function(){return t()||y},android:function(){return t()||p},ipad:function(){return t()||m}},x=S,E=!("undefined"==typeof window||!window.document||!window.document.createElement),L={canUseDOM:E,canUseWorkers:"undefined"!=typeof Worker,canUseEventListeners:E&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:E&&!!window.screen,isInWorker:!E};L.canUseDOM&&(g=document.implementation&&document.implementation.hasFeature&&!0!==document.implementation.hasFeature("",""));var T=function(e,t){if(!L.canUseDOM||t&&!("addEventListener"in document))return!1;var o="on"+e,n=o in document;if(!n){var r=document.createElement("div");r.setAttribute(o,"return;"),n="function"==typeof r[o]}return!n&&g&&"wheel"===e&&(n=document.implementation.hasFeature("Events.wheel","3.0")),n},M=10,X=40,Y=800;o.getEventType=function(){return x.firefox()?"DOMMouseScroll":T("wheel")?"wheel":"mousewheel"};var D=o,N=!1;try{var W=Object.defineProperty({},"passive",{get:function(){N=!0}});window.addEventListener("test",null,W)}catch(e){}var P="MutationObserver"in window,O="mousemove",k="mouseup",H={name:"scrolly",props:{parentScroll:{type:Boolean,default:!0},passiveScroll:{type:Boolean,default:!1}},data:function(){return{container:null,viewport:null,barX:null,barY:null,onMouseWheelHandler:null,onDomChangeHandler:null,mutationObserver:null,isScrolling:!1,touchStartX:null,touchStartY:null}},computed:{classnames:function(){return["scrolly",this.isScrolling?"is-scrolling":""]}},mounted:function(){this.$nextTick(function(){for(var e,t,o,n,r=this.$el,a=r.childNodes,i=0;n=a[i++];){var l=n.className;l&&(l.match("scrolly-viewport")&&(e=n),l.match("axis-x")&&(t=n),l.match("axis-y")&&(o=n))}if(e&&(t||o)){var s=this.onMouseWheel.bind(this),c=!!this.parentScroll&&this.passiveScroll;r.addEventListener("wheel",s,!!N&&{passive:c}),r.addEventListener("touchstart",this.onTouchStart),r.addEventListener("touchend",this.onTouchEnd),r.addEventListener("touchmove",this.onTouchMove,!!N&&{passive:c});var d,u=this.onDomChange.bind(this);P?(d=new MutationObserver(u)).observe(e,{childList:!0,characterData:!0,subtree:!0,attributes:!0}):(e.addEventListener("DOMSubtreeModified",u),e.addEventListener("propertychange",u)),Object.assign(this,{container:r,viewport:e,barX:t,barY:o,onMouseWheelHandler:s,onDomChangeHandler:u,mutationObserver:d})}})},methods:{onMouseEnter:function(){this.refreshScrollLayout()},onMouseDown:function(e){function t(e){e.preventDefault();var t=e.pageX,o=e.pageY;if(m){var l=p.scrollLeft,d=p.scrollWidth,f=p.offsetWidth,v=r.offsetWidth,w=f-v,S=g+(t-a);S<0&&(S=0),S>w&&(S=w),r.style.left=n(S/f),p.scrollLeft=S/w*(d-f);var x=S<0,E=S>w,L=x||E;s.x=u.scrollLayout={barX:u,scrollLeft:l,scrollWidth:d,viewportWidth:f,barWidth:v,barLeft:S,minBarLeft:0,maxBarLeft:w,visible:!0,onLeftEdge:x,onRightEdge:E,onEdge:L,canUnlockParentScroll:!1,canScrollParent:!1}}if(y){var T=p.scrollTop,M=p.scrollHeight,X=p.offsetHeight,Y=r.offsetHeight,D=X-Y,N=b+(o-i);N<0&&(N=0),N>D&&(N=D),r.style.top=n(N/X),p.scrollTop=N/D*(M-X);var W=N<=0,P=N>=D,O=W||P;s.y=h.scrollLayout={barY:h,scrollTop:T,scrollHeight:M,viewportHeight:X,barHeight:Y,barTop:N,minBarTop:0,maxBarTop:D,onTopEdge:W,onBottomEdge:P,onEdge:O,visible:!0,canUnlockParentScroll:!1,canScrollParent:!1,scrolled:!0}}c.$emit("scrollchange",s)}function o(){c.isScrolling=!1,v(k,o),v(O,t)}var r=e.target,a=e.pageX,i=e.pageY,l=r.className;if(l.match("scrolly-bar")){var s={},c=this,d=this,u=d.barX,h=d.barY,p=this.viewport,f=window.addEventListener,v=window.removeEventListener,m=l.match("axis-x"),y=l.match("axis-y"),b=r.offsetTop,g=r.offsetLeft;c.isScrolling=!0,f("mousemove",t),f("mouseup",o)}},onTouchStart:function(e){this.touchStartX=e.touches[0].pageX,this.touchStartY=e.touches[0].pageY},onTouchEnd:function(){this.touchStartX=null,this.touchStartY=null},onTouchMove:function(e){this.touchStartX||(this.touchStartX=e.touches[0].pageX,this.touchStartY=e.touches[0].pageY);var t=e.touches[0].pageX-this.touchStartX,o=e.touches[0].pageY-this.touchStartY;this.touchStartX=e.touches[0].pageX,this.touchStartY=e.touches[0].pageY;var n=this.refreshScrollLayout(t,o),r=n.x,a=n.y;if(!this.passiveScroll){var i=r&&r.canScrollParent,l=a&&a.canScrollParent;(!this.parentScroll||!(i||l))&&e.preventDefault()}},onMouseWheel:function(e){var t=D(e),o=t.pixelX,n=t.pixelY,r=this.refreshScrollLayout(o,n),a=r.x,i=r.y;if(!this.passiveScroll){var l=a&&a.canScrollParent,s=i&&i.canScrollParent;(!this.parentScroll||!(l||s))&&e.preventDefault()}},onMouseLeave:function(e){var t=this,o=t.barX,n=t.barY;o&&(o.scrollLayout=null),n&&(n.scrollLayout=null)},onDomChange:function(e,t,o){t||(t=250);var n,r;return function(){var a=o||this,i=+new Date,l=arguments;n&&i<n+t?(clearTimeout(r),r=setTimeout(function(){n=i,e.apply(a,l)},t)):(n=i,e.apply(a,l))}}(function(){this.refreshScrollLayout()},250),refreshScrollLayout:function(e,t){void 0===e&&(e=0),void 0===t&&(t=0);var o={},r=this,a=r.viewport,i=r.barX,l=r.barY;if(i){var s=0!==e;a.scrollLeft+=e;var c=a.scrollLeft,d=a.scrollWidth,u=a.offsetWidth,h=i.style;h.visibility="hidden",h.display="block",h.width=n(u/d);var p=i.offsetWidth,f=u-p,v=c/(d-u)*f||0,m=v<0,y=v>f,b=m||y;m&&(v=0),y&&(v=f),h.left=n(v/u);var g=p<u;h.display=g?"block":"none",h.visibility="visible";var w=Math.abs(e)>25,S=i.scrollLayout||{},x=S.onEdge,E=S.canUnlockParentScroll,L=!!(S.canScrollParent||x&&E);o.x=i.scrollLayout={barX:i,scrollLeft:c,scrollWidth:d,viewportWidth:u,barWidth:p,barLeft:v,minBarLeft:0,maxBarLeft:f,onLeftEdge:m,onRightEdge:y,onEdge:b,visible:g,canUnlockParentScroll:w,canScrollParent:L,scrolled:s}}if(l){var T=0!==t;a.scrollTop+=t;var M=a.scrollTop,X=a.scrollHeight,Y=a.offsetHeight,D=l.style;D.visibility="hidden",D.display="block",D.height=n(Y/X);var N=l.offsetHeight,W=Y-N,P=M/(X-Y)*W||0,O=P<=0,k=P>=W,H=O||k;O&&(P=0),k&&(P=W),D.top=n(P/Y);var B=N<Y;D.display=B?"block":"none",D.visibility="visible";var F=Math.abs(t)>25,_=l.scrollLayout||{},C=_.onEdge,U=_.canUnlockParentScroll,A=_.canScrollParent,V=!(!H||!(A||C&&U));o.y=l.scrollLayout={barY:l,scrollTop:M,scrollHeight:X,viewportHeight:Y,barHeight:N,barTop:P,minBarTop:0,maxBarTop:W,onTopEdge:O,onBottomEdge:k,onEdge:H,visible:B,canUnlockParentScroll:F,canScrollParent:V,scrolled:T}}return this.$emit("scrollchange",o),o}},beforeDestroy:function(){var e=this,t=e.container,o=e.viewport,n=e.onMouseWheelHandler,r=e.onDomChangeHandler,a=e.mutationObserver;a&&a.disconnect(),P||(o.removeEventListener("DOMSubtreeModified",r),o.removeEventListener("propertychange",r)),t.removeEventListener("wheel",n)}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style"),o='.scrolly { position: relative; } .scrolly .scrolly-bar { opacity: 0; } .scrolly:hover .scrolly-bar, .scrolly.is-scrolling .scrolly-bar { opacity: 1; } .scrolly-viewport { position: absolute; overflow: hidden; width: 100%; height: 100%; z-index: 1; } .scrolly-bar { position: absolute; border: 7px solid transparent; cursor: pointer; z-index: 2; transition: opacity .1s ease; } .scrolly-bar:before { position: absolute; width: 100%; height: 100%; content: " "; background: rgba(0, 0, 0, 0.3); border-radius: 7px; transition: background .2s ease; } .scrolly-bar:hover:before { background: rgba(0, 0, 0, 0.6); } .scrolly-bar.axis-x { left: 0; bottom: 0; width: 100%; height: 21px; min-width: 20%; max-width: 100%; } .scrolly-bar.axis-y { top: 0; right: 0; width: 21px; height: 100%; min-height: 20%; max-height: 100%; } ';t.type="text/css",t.styleSheet?t.styleSheet.cssText=o:t.appendChild(document.createTextNode(o)),e.appendChild(t)}}();var B=Object.assign(H,{render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classnames,on:{mouseenter:e.onMouseEnter,mousedown:e.onMouseDown,mouseleave:e.onMouseLeave}},[e._t("default")],2)},staticRenderFns:[]});B.prototype=H.prototype,function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText="":t.appendChild(document.createTextNode("")),e.appendChild(t)}}();var F={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classnames},[e._t("default")],2)},staticRenderFns:[],name:"scrolly-viewport",computed:{classnames:function(){return["scrolly-viewport"]}}};!function(){if("undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],t=document.createElement("style");t.type="text/css",t.styleSheet?t.styleSheet.cssText="":t.appendChild(document.createTextNode("")),e.appendChild(t)}}();var _={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.classnames},[e._t("default")],2)},staticRenderFns:[],name:"scrolly-bar",props:{axis:{type:String,default:"y"}},computed:{classnames:function(){return["scrolly-bar","axis-"+this.axis]}}};"undefined"!=typeof window&&window.Vue&&(window.Vue.component("scrolly",B),window.Vue.component("scrolly-viewport",F),window.Vue.component("scrolly-bar",_)),e.Scrolly=B,e.ScrollyViewport=F,e.ScrollyBar=_,Object.defineProperty(e,"__esModule",{value:!0})});
